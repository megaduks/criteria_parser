eligibility_criteria_parser
================

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Install

In order to install the module issue the following commands

``` sh
bash$ git clone https://github.com/megaduks/criteria_parser.git

bash$ cd criteria_parser

bash$ pip install -r requirements.txt

bash$ pip install -e '.[dev]'
```

The next step is to run `dvc` to download the data

``` bash
bash$ dvc pull
```

## How to use

Here is how you can load the Chia dataset for easy processing

``` python
from eligibility_criteria_parser.core import *

df = load_eligibility_criteria()
```

``` python
df.head()
```

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ct_no</th>
      <th>criteria</th>
      <th>mode</th>
      <th>drugs</th>
      <th>persons</th>
      <th>procedures</th>
      <th>conditions</th>
      <th>devices</th>
      <th>visits</th>
      <th>scopes</th>
      <th>observations</th>
      <th>measurements</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NCT03124329</td>
      <td>Male and female individuals between ages of 18...</td>
      <td>inclusion</td>
      <td>None</td>
      <td>[ages]</td>
      <td>None</td>
      <td>[gingival recession defects, recession defects]</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>[cervical restorations extending to the CEJ]</td>
      <td>[recession, keratinized gingiva, Miller]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NCT02796378</td>
      <td>Elevated blood-cholesterol</td>
      <td>inclusion</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>[blood-cholesterol]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NCT03216967</td>
      <td>Adult patients Kidney transplant recipients Pa...</td>
      <td>inclusion</td>
      <td>[calcineurin inhibitor, mycophenolic acid]</td>
      <td>[Adult]</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>[Viremia, pregnancy test, blood ß-HCG dosage]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NCT02200978</td>
      <td>Patients less than 16 years old with newly dia...</td>
      <td>inclusion</td>
      <td>None</td>
      <td>[old]</td>
      <td>None</td>
      <td>[acute promyelocytic leukemia]</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>[PML-RARa]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NCT01314898</td>
      <td>Male and/or female healthy volunteers, age 18 ...</td>
      <td>inclusion</td>
      <td>None</td>
      <td>[Male, female, age, Females]</td>
      <td>None</td>
      <td>[healthy, childbearing potential]</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>None</td>
      <td>[Body Mass Index (BMI), total body weight]</td>
    </tr>
  </tbody>
</table>
</div>

``` python
df.columns
```

    Index(['ct_no', 'criteria', 'mode', 'drugs', 'persons', 'procedures',
           'conditions', 'devices', 'visits', 'scopes', 'observations',
           'measurements'],
          dtype='object')

``` python
df.shape
```

    (2000, 12)

A simple function can compute the metric of entity coverage

------------------------------------------------------------------------

<a
href="https://github.com/Mikołaj%20Morzy/eligibility_criteria_parser/blob/main/eligibility_criteria_parser/core.py#LNone"
target="_blank" style="float:right; font-size:smaller">source</a>

### entity_coverage

>      entity_coverage (ents_true:List[str], ents_pred:List[str],
>                       symmetric:bool=True)

Compute the compound metric of entity coverage in eligibility criteria

Args: ents_true: list of entities from Chia annotations ents_pred: list
of entities returned from LM symmetric: if True, the Jaccard denominator
is the union of sets of entities, otherwise only true entities are
counted in the denominator

For each entity in a criterion, find the predicted entity which
maximizes the Jaccard score and return the average Jaccard score for
matched entities and the percentage of entites for which any matching
has been found

``` python
ents_true = ['adult', 'no alcohol substance abuse', 'cardiovascular disease', 'elevated cholesterol']
ents_pred = ['adult man or woman', 'no alcohol usage during last year', 'high blood pressure']

entity_coverage(ents_true=ents_true, ents_pred=ents_pred)
```

    (0.25, 0.5)
